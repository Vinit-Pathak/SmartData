<div class="main-container">

  <!-- Floating Add Product Button -->
  <div class="floating-btn-container">
    <button class="btn-add-product" (click)="openAddForm()">
      <i class="fas fa-plus"></i> Add New Product
    </button>
  </div>

  <!-- Update Product Form -->
  <div *ngIf="isUpdating" class="form-overlay">
    <div class="form-container fade-in">
      <form [formGroup]="updateForm" class="form">
        <div class="form-header text-center">
          <h3>Update Product</h3>
        </div>

        <button type="button" class="btn btn-back" (click)="OnBack()">
          <i class="fas fa-arrow-left"></i> Back
        </button>

        <div class="form-fields">
          <div class="form-group">
            <label for="productName" class="form-label">Product Name</label>
            <input type="text" class="form-control" id="productName" formControlName="productName" placeholder="Enter product name" />
          </div>

          <div class="form-group">
            <label for="productCode" class="form-label">Product Code</label>
            <input type="text" class="form-control" id="productCode" formControlName="productCode" placeholder="Enter product code" />
          </div>

          <div class="form-group">
            <label for="brand" class="form-label">Brand</label>
            <input type="text" class="form-control" id="brand" formControlName="brand" placeholder="Enter brand name" />
          </div>

          <div class="form-group">
            <label for="category" class="form-label">Category</label>
            <input type="text" class="form-control" id="category" formControlName="category" placeholder="Enter category name" />
          </div>

          <div class="form-group">
            <label for="productImage" class="form-label">Product Image</label>
            <input type="file" class="form-control" id="productImage" formControlName="file" (change)="onFileSelected($event)" />
          </div>

          <div class="form-group">
            <label for="sellingPrice" class="form-label">Selling Price</label>
            <input type="number" class="form-control" id="sellingPrice" formControlName="sellingPrice" placeholder="Enter selling price" />
          </div>

          <div class="form-group">
            <label for="purchasePrice" class="form-label">Purchase Price</label>
            <input type="number" class="form-control" id="purchasePrice" formControlName="purchasePrice" placeholder="Enter purchase price" />
          </div>

          <div class="form-group">
            <label for="purchaseDate" class="form-label">Purchase Date</label>
            <input type="date" class="form-control" id="purchaseDate" formControlName="purchaseDate" />
          </div>

          <div class="form-group">
            <label for="stock" class="form-label">Stock</label>
            <input type="number" class="form-control" id="stock" formControlName="stock" placeholder="Enter stock quantity" />
          </div>
        </div>

        <button type="submit" class="btn btn-submit" (click)="onUpdate()" [disabled]="updateForm.invalid">
          <i class="fas fa-save"></i> Update
        </button>
      </form>
    </div>
  </div>

  <!-- Add New Product Form -->
  <div *ngIf="isAdding" class="form-overlay">
    <div class="form-container fade-in">
      <form [formGroup]="addForm" class="form">
        <div class="form-header text-center">
          <h3>Add New Product</h3>
        </div>

        <button type="button" class="btn btn-back" (click)="closeAddForm()">
          <i class="fas fa-arrow-left"></i> Back
        </button>

        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label for="productName" class="form-label">Product Name</label>
              <input type="text" class="form-control" id="productName" formControlName="productName" placeholder="Enter product name" required />
            </div>

            <div class="form-group">
              <label for="productCode" class="form-label">Product Code</label>
              <input type="text" class="form-control" id="productCode" formControlName="productCode" placeholder="Enter product code" required />
            </div>

            <div class="form-group">
              <label for="brand" class="form-label">Brand</label>
              <input type="text" class="form-control" id="brand" formControlName="brand" placeholder="Enter brand name" required />
            </div>

            <div class="form-group">
              <label for="productImage" class="form-label">Product Image</label>
              <input type="file" class="form-control" id="productImage" formControlName="file" (change)="onFileSelectedAdd($event)" />
            </div>

            <div class="form-group">
              <label for="sellingPrice" class="form-label">Selling Price</label>
              <input type="number" class="form-control" id="sellingPrice" formControlName="sellingPrice" placeholder="Enter selling price" required />
            </div>
          </div>

          <div class="col-md-6">
            <div class="form-group">
              <label for="category" class="form-label">Category</label>
              <input type="text" class="form-control" id="category" formControlName="category" placeholder="Enter category name" required />
            </div>

            <div class="form-group">
              <label for="purchasePrice" class="form-label">Purchase Price</label>
              <input type="number" class="form-control" id="purchasePrice" formControlName="purchasePrice" placeholder="Enter purchase price" required />
            </div>

            <div class="form-group">
              <label for="purchaseDate" class="form-label">Purchase Date</label>
              <input type="date" class="form-control" id="purchaseDate" formControlName="purchaseDate" required />
            </div>

            <div class="form-group">
              <label for="stock" class="form-label">Stock</label>
              <input type="number" class="form-control" id="stock" formControlName="stock" placeholder="Enter stock quantity" required />
            </div>
          </div>
        </div>

        <button type="submit" class="btn btn-submit" (click)="onAdd()" [disabled]="addForm.invalid">
          <i class="fas fa-save"></i> Add Product
        </button>
      </form>
    </div>
  </div>

  <!-- Product List -->
  <div *ngIf="!isUpdating && !isAdding">
    <h2 class="text-center mt-3">Product Details</h2>

    <div *ngIf="products && products.length > 0; else noData">
      <div class="product-cards-container row">
        <div class="product-card col-md-3 mt-4" *ngFor="let product of products; let i = index">
          <div class="product-card-body">
            <h4>{{ product.productName }}</h4>
            <img [src]="product.productImage" alt="{{ product.productName }}" class="img-fluid">
            <p>Code: {{ product.productCode }}</p>
            <p>Category: {{ product.category }}</p>
            <p>Brand: {{ product.brand }}</p>
            <p>Selling Price: ${{ product.sellingPrice }}</p>
            <p>Stock: {{ product.stock }}</p>
          </div>

          <div class="product-card-actions">
            <button class="btn btn-info" (click)="onEdit(product)">
              <i class="fas fa-edit"></i> Edit
            </button>
            <button class="btn btn-danger" (click)="onDelete(product.id)">
              <i class="fas fa-trash-alt"></i> Delete
            </button>
          </div>
        </div>
      </div>
    </div>

    <ng-template #noData>
      <div class="alert alert-info text-center" role="alert">
        No Product Available
      </div>
    </ng-template>
  </div>
</div>